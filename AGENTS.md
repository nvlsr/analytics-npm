# Repository Guidelines

## Project Structure & Module Organization
- `src/` holds the TypeScript source; client utilities live beside server helpers (for example, `visitor-tracker.tsx` for React components and `server.ts` for Node entry points). Keep related modules co-located and reuse existing utility files before creating new ones.
- `dist/` contains the build artifacts generated by `tsup`. Do not edit files hereâ€”always change the corresponding source module and rebuild.
- `tsup.config.ts`, `tsconfig.json`, and the root `package.json` define the build pipeline and module exports; review these when adding entry points or altering published surfaces.

## Build, Test, and Development Commands
- `npm run build` bundles the library with `tsup`, producing dual ESM/CJS outputs in `dist/`.
- `npm run dev` runs `tsup --watch` for iterative development; it recompiles on every change under `src/`.
- `npm run clean` removes the `dist/` directory. Pair with `npm run build` when validating production artifacts.
- `npm run prepublishOnly` performs a clean rebuild before publishing; run it locally before tagging a release.

## Coding Style & Naming Conventions
- Follow the existing 2-space indentation and double-quoted strings seen across `src/`. Maintain strict TypeScript settings (`strict`, `noImplicitReturns`) and avoid `any` unless justified.
- Export modules via explicit named exports; mirror the pattern from `src/index.ts` so tree-shaking stays effective.
- Use `camelCase` for functions and constants, `PascalCase` for components and types, and keep file names kebab-cased to match current modules.

## Testing Guidelines
- No automated tests ship yet; `npm test` intentionally exits with code 1. When adding coverage, place specs under `src/__tests__/` (or `*.test.ts`) and wire the chosen runner (e.g., Vitest or Jest) into the `test` script.
- Favor deterministic unit tests for utilities and integration tests for request/response flows in `server.ts`. Document any required environment variables in the test README.

## Commit & Pull Request Guidelines
- Recent commits vary in quality (`git log -5` shows messages like `fix`); prefer deliberate summaries such as `feat(visitor-tracker): add beacon fallback`. Include scope when helpful.
- For pull requests, provide: the change summary, validation steps (`npm run build`, manual checks), linked issues, and screenshots if UI metrics are affected. Call out breaking changes or new environment expectations in bold within the PR body.
